<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<title>Desafio Log√≠stico</title>
<style>
body { 
  font-family: Arial, sans-serif; 
  text-align: center; 
  margin: 0; 
  padding: 0; 
  background: #f5f5f5;
}
h1 { 
  font-family: 'Garamond', serif; 
  font-size: 24px; 
  margin: 10px; 
  color: #333;
}
#tabuleiro { 
  display: grid; 
  grid-template-columns: repeat(5, 70px); 
  grid-gap: 6px; 
  margin: 15px auto; 
  width: max-content; 
  position: relative; 
}
.casa { 
  width: 70px; 
  height: 70px; 
  border-radius: 10px;
  border: 1px solid #444; 
  display: flex; 
  align-items: center; 
  justify-content: center; 
  flex-direction: column; 
  font-size: 13px; 
  position: relative; 
  background: #fff; 
  box-shadow: 0 4px 6px rgba(0,0,0,0.2), inset 0 2px 4px rgba(255,255,255,0.7);
  transition: transform 0.1s ease;
}
.casa:active {
  transform: scale(0.96);
}
.azul { background: linear-gradient(to bottom, #aee1f9, #6bbce9); }
.transbordo { border: 3px solid gold; }
.vermelha { background: linear-gradient(to bottom, #ff9a9a, #e95f5f); }
#painel { 
  margin: 10px auto; 
  font-size: 16px; 
  background: #fff; 
  width: 90%; 
  max-width: 400px; 
  border-radius: 12px; 
  padding: 10px; 
  box-shadow: 0 4px 6px rgba(0,0,0,0.15);
}
#opcoes { 
  margin: 15px auto; 
  display: flex; 
  flex-wrap: wrap; 
  justify-content: center; 
  gap: 10px; 
  max-width: 420px;
}
button { 
  padding: 10px 15px; 
  cursor: pointer; 
  border: none; 
  color: #fff; 
  font-weight: bold; 
  border-radius: 8px; 
  box-shadow: 0 4px 6px rgba(0,0,0,0.2); 
  transition: transform 0.1s ease;
}
button:active { transform: scale(0.94); }
button.permitido { background-color: #28a745; }
button.proibido { background-color: #d9534f; cursor: not-allowed; }
button.reiniciar { background-color: #f39c12; }
button:not(.proibido):hover { filter: brightness(1.1); }

.jogador { 
  width: 40px; 
  height: 40px; 
  background-color: gold; 
  position: absolute; 
  border-radius: 50%; 
  display: flex; 
  align-items: center; 
  justify-content: center; 
  font-weight: bold; 
  transition: all 0.5s ease; 
  box-shadow: 0 4px 6px rgba(0,0,0,0.4);
}
.seta { position: absolute; font-size: 16px; top: 5px; right: 5px; }
.seta.transbordo { color: orange; font-weight: bold; }
#legenda { margin-top: 10px; font-size: 14px; }
#evento { margin-top: 10px; font-size: 16px; color: red; font-weight: bold; min-height: 24px; }
#assinatura { position: fixed; bottom: 5px; right: 10px; font-size: 12px; color: #444; }
</style>
</head>
<body>

<h1>Desafio Log√≠stico: em quanto tempo voc√™ chega? Geografia dos Transportes</h1>
<div id="tabuleiro"></div>

<div id="painel">
üí∞ Dinheiro: R$ <span id="dinheiro">100</span><br>
‚è≥ Dias: <span id="dias">0</span><br>
üìç Posi√ß√£o: <span id="posicao">0</span>
</div>

<div id="opcoes"></div>

<div id="evento"></div>

<div id="legenda">
<p>üü¢ Atalhos: voc√™ pode pular diretamente para outra casa</p>
</div>

<div id="assinatura">por Prof. Henrique Pinto</div>

<script>
const tamanho = 20;
let dinheiro = 100;
let dias = 0;
let posicao = 0;

const tabuleiro = document.getElementById("tabuleiro");
const opcoesDiv = document.getElementById("opcoes");
const eventoDiv = document.getElementById("evento");

const caminhos = {
  0: [1,2], 1:[3], 2:[4], 3:[4], 4:[6,5],
  5:[10], 10:[15], 15:[16],
  6:[7], 7:[8], 8:[9], 9:[11], 11:[12], 12:[13], 13:[14], 14:[16],
  16:[17],17:[18],18:[19],19:[]
};

const casasAzuis = [5,10,15];
const transbordos = [5,15];
const atalhos = {2:6,8:12,12:16};
const atalhosVisiveis = {2:6,8:12,12:16};

// Novo controle de eventos aleat√≥rios
let ultimoTransporte = null;
let contadorSeguidos = 0;

// Criar casas
for (let i=0;i<tamanho;i++){
  const casa = document.createElement("div");
  casa.classList.add("casa");
  const numero = document.createElement("div");
  numero.textContent = i;
  casa.appendChild(numero);

  const proxs = caminhos[i] || [];
  proxs.forEach(p=>{
    const seta = document.createElement("div");
    seta.classList.add("seta");
    if(transbordos.includes(i)) seta.classList.add("transbordo");
    if(p>i && p%5>i%5) seta.textContent="‚Üò";
    else if(p>i && p%5===i%5) seta.textContent="‚Üì";
    else seta.textContent="‚Üí";
    casa.appendChild(seta);
  });

  if(atalhosVisiveis[i]){
    const iconeAtalho = document.createElement("div");
    iconeAtalho.textContent = "üü¢";
    iconeAtalho.style.position = "absolute";
    iconeAtalho.style.bottom = "2px";
    iconeAtalho.style.left = "2px";
    casa.appendChild(iconeAtalho);
  }

  if(casasAzuis.includes(i)) casa.classList.add("azul");
  if(transbordos.includes(i)) casa.classList.add("transbordo");
  if(i===tamanho-1) casa.classList.add("vermelha");
  tabuleiro.appendChild(casa);
}

// Jogador
const jogador = document.createElement("div");
jogador.classList.add("jogador");
jogador.textContent = "üöö";
tabuleiro.appendChild(jogador);

function atualizarPainel(){
  document.getElementById("dinheiro").textContent = dinheiro;
  document.getElementById("dias").textContent = dias;
  document.getElementById("posicao").textContent = posicao;
}

function atualizarPosicao(){
  const casas = document.querySelectorAll(".casa");
  const casaAtual = casas[posicao];
  const rect = casaAtual.getBoundingClientRect();
  const tabRect = tabuleiro.getBoundingClientRect();
  jogador.style.left = rect.left - tabRect.left + 15 + "px";
  jogador.style.top = rect.top - tabRect.top + 15 + "px";
}

function mostrarOpcoes(){
  opcoesDiv.innerHTML="<h3 style='width:100%; text-align:center;'>Escolha o meio de transporte:</h3>";

  if(posicao===15){
    const btnNavio = document.createElement("button");
    btnNavio.textContent="Navio gr√°tis (fila 5 dias, vai para casa 16)";
    btnNavio.classList.add("permitido");
    btnNavio.onclick = ()=>{
      dias +=5;
      posicao=16;
      atualizarPainel();
      atualizarPosicao();
      verificarFim();
    };
    opcoesDiv.appendChild(btnNavio);

    criarBotaoTransbordo(16,1,10,"Transbordo para casa branca 16 (R$10, +1 dia)");
    return;
  }

  const transportes = [
    {nome:"Carro",custo:10,tempo:2},
    {nome:"Trem",custo:8,tempo:3},
    {nome:"Navio",custo:6,tempo:5},
    {nome:"Avi√£o",custo:18,tempo:0.5}
  ];

  if(posicao===0){
    criarBotaoTransbordo(5,1,5,"Transbordo inicial para casa azul 5 (R$5)");
  }

  const proxs = caminhos[posicao] || [];
  transportes.forEach(t=>{
    let permitido=true;
    const azulDestino = proxs.some(p=>casasAzuis.includes(p));
    if(casasAzuis.includes(posicao)) permitido = t.nome==="Navio";
    else if(t.nome==="Navio") permitido = azulDestino;
    const btnClass = permitido?"permitido":"proibido";
    const btn = document.createElement("button");
    btn.textContent=`${t.nome} (R$${t.custo}, ${t.tempo} dias)`;
    btn.classList.add(btnClass);
    if(permitido) btn.onclick=()=>escolherCaminho(t);
    opcoesDiv.appendChild(btn);
  });

  if(posicao===4){
    criarBotaoTransbordo(6,1,5,"Pagar ped√°gio da ponte (R$5) e seguir para casa 6");
    criarBotaoTransbordo(5,1,5,"Transbordo para casa azul 5 (R$5)");
  }
}

function criarBotaoTransbordo(destino,diasTransbordo,custo,texto){
  const btn = document.createElement("button");
  btn.textContent=texto;
  btn.classList.add("permitido");
  btn.onclick=()=>pagarTransbordo(destino,diasTransbordo,custo);
  opcoesDiv.appendChild(btn);
}

function pagarTransbordo(destino,diasTransbordo,custo){
  if(dinheiro<custo){alert("üí∏ Dinheiro insuficiente!"); return;}
  dinheiro -=custo;
  dias +=diasTransbordo;
  posicao = destino;
  if(casasAzuis.includes(posicao)) dias+=2;
  if(atalhos[posicao]) posicao = atalhos[posicao];
  atualizarPainel();
  atualizarPosicao();
  verificarFim();
}

function escolherCaminho(transporte){
  const proximasCasas = caminhos[posicao] || [];

  if(transporte.nome !== "Carro"){
    mover(transporte, proximasCasas[0]);
    return;
  }

  if(proximasCasas.length===1){
    mover(transporte,proximasCasas[0]);
  } else{
    opcoesDiv.innerHTML="<h3 style='width:100%; text-align:center;'>Escolha a pr√≥xima casa:</h3>";
    proximasCasas.forEach(c=>{
      const btn = document.createElement("button");
      btn.textContent=`Casa ${c}`;
      btn.classList.add("permitido");
      btn.onclick=()=>mover(transporte,c);
      opcoesDiv.appendChild(btn);
    });
  }
}

function mover(transporte,casaDestino){
  if(dinheiro<transporte.custo){alert("üí∏ Dinheiro insuficiente!"); return;}
  dinheiro -= transporte.custo;
  dias += transporte.tempo;
  posicao = casaDestino;
  if(casasAzuis.includes(posicao)) dias+=2;
  if(atalhos[posicao]) posicao=atalhos[posicao];

  if(transporte.nome==="Carro" || transporte.nome==="Trem"){
    if(ultimoTransporte===transporte.nome){
      contadorSeguidos++;
    } else {
      contadorSeguidos=1;
    }
    ultimoTransporte = transporte.nome;

    if(contadorSeguidos===3){
      if(transporte.nome==="Carro"){
        const eventosRodoviario=["üöß Congestionamento! +2 dias","üî® Obras na via! +2 dia","üí∏ Roubaram sua carga! (-10 R$)","‚úä Greve dos caminhoneiros! +3 dias"];
        let evento = eventosRodoviario[Math.floor(Math.random()*eventosRodoviario.length)];
        eventoDiv.textContent = evento;
        if(evento.includes("+2 dias")) dias+=2;
        if(evento.includes("+3 dias")) dias+=3;
        if(evento.includes("-10")) dinheiro-=10;
      } else if(transporte.nome==="Trem"){
        const eventosFerroviario=["üêÇ Animais na via! +2 dias","üöß Trilhos obstru√≠dos! +3 dias","üöâ T√∫nel fechado! +2 dias","üí• Descarrilhou!!! +4 dias"];
        let evento = eventosFerroviario[Math.floor(Math.random()*eventosFerroviario.length)];
        eventoDiv.textContent = evento;
        if(evento.includes("+2 dias")) dias+=2;
        if(evento.includes("+3 dias")) dias+=3;
        if(evento.includes("+4 dias")) dias+=4;
      }
      contadorSeguidos=0;
    } else {
      eventoDiv.textContent="";
    }
  }

  atualizarPainel();
  atualizarPosicao();
  verificarFim();
}

function verificarFim(){
  if(dinheiro<=0){
    alert(`üíÄ Fim do dinheiro! Voc√™ chegou √† casa ${posicao} em ${dias} dias.`);
    mostrarReiniciar();
  } else if(posicao>=tamanho-1){
    alert(`üéâ Parab√©ns! Voc√™ chegou ao destino em ${dias} dias com R$${dinheiro} restantes!`);
    mostrarReiniciar();
  } else{
    mostrarOpcoes();
  }
}

function mostrarReiniciar(){
  opcoesDiv.innerHTML="";
  const btn = document.createElement("button");
  btn.textContent="Reiniciar Jogo";
  btn.classList.add("reiniciar");
  btn.onclick=()=>window.location.reload();
  opcoesDiv.appendChild(btn);
}

atualizarPainel();
atualizarPosicao();
mostrarOpcoes();
</script>
</body>
</html>
